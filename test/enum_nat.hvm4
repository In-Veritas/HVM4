// This shows how to use a 'pseudo-metavar' to invert the binary add function,
// and solve the equation: 'X * 20 = 5000'. Run it with collapse mode:
// $ hvml run pseudo_metavar_nat.hvml -C -s
// Unary Peano Nats

// data Nat { #Z #S{pred} }

// If-Then-Else
//@if(b t f) = ~b {
 // 0: f
 // _: t
//}

@if = λ{
  #T: λt.λf.t
  #F: λt.λf.f
}

@add = λ{ #Z: λb.b ; #S: λp.#S{@add(p, b)}; }
@mul = λ{ #Z: λb.#Z{} ; #S: λp.λb. !B&A=b @add(B₀, @mul(p, B₁)); }

@eq = λ{
  #Z: λ{
    #Z: #T{}
    #S: λbp. #F{}
  };
  #S: λap.λ{
    #Z: #F{}
    #S: λbp. @eq(ap, bp)
  };
}

@X = &Z{#Z{} #S{@X}}

@two = #S{#S{#Z{}}}
@four = #S{#S{#S{#S{#Z{}}}}}

// solves x * 2 = 4
// @main = @if(@eq(@mul(@X, @two), @four), @X, &{}) => NEEDS COLLAPSER TO WORK
@main = #Z{}
// NEEDS COLLAPSER
